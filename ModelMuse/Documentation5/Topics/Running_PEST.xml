<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2022-01-24T16:05:06.778-05:00" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Running PEST</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Running PEST</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When creating the files needed to run the forward model and PEST, ModelMuse creates two separate batch files to run the model. One of them is named RunModel.bat used by PEST to run the model. The other will be named RunModflow.bat or RunSutra.bat. Depending on the type of model, one or the other of the latter batch files must be run once before starting PEST to run a utility program to create an instruction file for PEST. Typically, running this latter batch file is the last step taken by ModelMuse when exporting the model input files. The batch file may also have instructions to run PLPROC scripts that will calculate kriging factors. The RunModel.bat file will run a utility program to extract simulated values in the format specified in the instruction file. The RunModel.bat may also perform kriging interpolation among pilot points using the kriging factors generated with the RunModflow.bat or RunSutra.bat files.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If pilot points are used, ModelMuse will also create a covariance matrix file for each set of pilot points on each layer. The covariance files will be to help constrain the values assigned to pilot points by assigning it to the PEST variable COVFLE in the Observations Groups section of the PEST control file. Each covariance matrix file will be created in a separate batch file. The modeler can examine the input to each batch file and rerun them with different options if desired. The covariance matrix files are created using two utility programs from the PEST groundwater utilities: MKPPSTAT and PPCOV_SVA.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Once the model is running properly (before using PEST but with all the parameters and calibration observations defined), the modeler runs the model once from ModelMuse. This ensures that the instruction file for PEST and any required kriging factors files will be created. Next, the modeler runs PEST by selecting </text><text styleclass="Strong" translate="true">File|Export|PEST|Export PEST control file</text><text styleclass="Normal" translate="true">. There are three radio buttons at the bottom of the &quot;Save As&quot; dialog box. They are labeled “</text><text styleclass="Strong" translate="true">Don&apos;t run</text><text styleclass="Normal" translate="true">”, “</text><text styleclass="Strong" translate="true">Run PESTCHEK</text><text styleclass="Normal" translate="true">”, and “</text><text styleclass="Strong" translate="true">Run PEST</text><text styleclass="Normal" translate="true">.” By default, </text><text styleclass="Strong" translate="true">Run PESTCHEK</text><text styleclass="Normal" translate="true"> will be selected. It is always a good idea to run PESTCHEK, a utility program that checks PEST settings before running PEST. If PESTCHEK detects any errors, the modeler must correct them before attempting to run PEST. If the errors involve parameters or observations, the modeler may need to rerun the ModelMuse model building utilities. Otherwise, the modeler may be able to make corrections in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties</link><text styleclass="Normal" translate="true"> dialog box and export the PEST control file again without exporting all the model input files or running the model.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Once no errors are detected by PESTCHEK, the modeler can run PEST by selecting </text><text styleclass="Strong" translate="true">Run PEST</text><text styleclass="Normal" translate="true"> in the &quot;Save As&quot; dialog box. It is also possible to run PESTCHEK or PEST using batch files named RunPestChek.bat and RunPest.bat. They are created at the same time the model input files are created.</text></para>
  </body>
</topic>
