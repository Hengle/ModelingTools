<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" status="Under Construction" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">PEST Calibration Observations</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">PEST Calibration Observations</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When PEST is estimating parameters, it compares simulated values from the model with measurements made in the field. It then adjusts parameters so that the simulated values more closely match the observed values in the hopes that this will improve model predictions. Typically, observations of several different types will be needed to properly estimate parameters. For example, if both recharge and hydraulic conductivity are being estimated, head observations alone will typically be insufficient to estimate the parameters uniquely. Instead, only the ratio of the recharge rate and hydraulic conductivity may be estimable. However, head observations combined with flow observations may allow them both to be estimated separately.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Sometimes the difference between two simulated values can be more helpful in estimating parameters than the simulated values themselves. Such comparisons can be defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Observation_Comparisons_Dialog" styleclass="Normal" translate="true">Observation Comparisons</link><text styleclass="Normal" translate="true"> dialog box. If the two simulated values to be compared are defined by the same object, they usually can be defined in the same dialog box as the direct observations.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When ModelMuse generates the MODFLOW 6 input files, it also generates two input files for one of the utility programs: </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf6ObsExtractor" styleclass="Normal" translate="true">Mf6ObsExtractor</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf2005ObsExtractor" styleclass="Normal" translate="true">Mf2005ObsExtractor</link><text styleclass="Normal" translate="true">, or </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SutraObsExtractor" styleclass="Normal" translate="true">SutraObsExtractor</link><text styleclass="Normal" translate="true">. With one of the files, the utility program generates an instruction file for PEST. With the other it processes the model output files to generate simulated values that can be compared with observed values. The instruction file is generated when you run the model from ModelMuse. The simulated values are extracted when PEST is running the model through the RumModel.bat batch file.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">For all calibration observations for PEST, you will need to define an observation name, the observed value, the weight and an observations group. Observation groups are defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="PEST_Properties_Observation_Gr" styleclass="Normal" translate="true">Observation Group Properties</link><text styleclass="Normal" translate="true"> pane of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Heading2_atoc_"><text styleclass="Heading2_atoc_" translate="true">MODFLOW 6</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">MODFLOW 6 provides the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="OBS_Observation_Utility_Packag" styleclass="Normal" translate="true">Observation Utility</link><text styleclass="Normal" translate="true"> to generate time-series of simulated values of many sorts including heads, and flows through boundaries. The simulated values are written at each time step and typically refer to values at a single cell. ModelMuse allows the user to define calibration observations for use with PEST based on the output of the Observation Utility. For head observations, the calibration observation is computed by interpolating in space and time to the observation location and time. For structured grids, the spatial calibration, bilinear interpolation is used from the surrounding cell centers to the observation location. For DISV grids, a linear, triangular, or quadrilateral finite-element basis function is used for spatial interpolation. Spatial interpolation among more than 4 points is not supported. Temporal interpolation is performed by linear interpolation between the time preceding and succeeding the observation time. Flows through boundaries may involve adding the flows from several objects. All calibration observations are defined on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="OBS_Observation_Utility_Pane" anchor="Calibration" styleclass="Normal" translate="true">Calibration tab</link><text styleclass="Normal" translate="true"> of the Observation Utility pane of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Heading2_atoc_"><text styleclass="Heading2_atoc_" translate="true">MODFLOW-2005</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">MODFLOW-2005 and related models such as MODFLOW-NWT have a built-in mechanism for defining head and flow observations at particular places and times. There are also several packages that generate simulated values that can be compared with observed values. As described in the MODFLOW-2005 documentaton, MODFLOW interpolates head observations in time and space to the location and time of the head observation. Observations defined for the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUB_Subsidence_and_Aquifer_Sys" styleclass="Normal" translate="true">SUB</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWT_Package" styleclass="Normal" translate="true">SWT</link><text styleclass="Normal" translate="true">, or </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWI2_Seawater_Intrusion_Packag" styleclass="Normal" translate="true">Seawater Intrusion</link><text styleclass="Normal" translate="true"> packages are interpolated in the same way by </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf2005ObsExtractor" styleclass="Normal" translate="true">Mf2005ObsExtractor</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Head observations are defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="HOB_Head_Observation_Package" styleclass="Normal" translate="true">Head Observation Package</link><text styleclass="Normal" translate="true">. Individual head observations are specified in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="HOB_Head_Observation_Package_P" styleclass="Normal" translate="true">Head Observations pane of the Object Properties dialog box</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Observations of flow through boundaries can be defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="CHOB_Specified_Head_Flow_Observations" styleclass="Normal" translate="true">CHOB</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="DROB_Drain_Observation_Package" styleclass="Normal" translate="true">DROB</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="GBOB_General_Head_Boundary_Observations" styleclass="Normal" translate="true">GBOB</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="RVOB_River_Observation_Package" styleclass="Normal" translate="true">RVOB</link><text styleclass="Normal" translate="true">, and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="STOB_Stream_Observation_Packag" styleclass="Normal" translate="true">STOB</link><text styleclass="Normal" translate="true"> packages. Individual flow observations are defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Manage_Flux_Observations" styleclass="Normal" translate="true">Manage Flow Observations</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="LAK_Lake_Package_Pane" styleclass="Normal" translate="true">Lake</link><text styleclass="Normal" translate="true"> package is used, you can use lake gages to export various lake properties such as the lake stage or the inflow or outflow from the lake. These can be used to define calibration observations on the &#160;</text><link displaytype="text" defaultstyle="true" type="topiclink" href="LAK_Object_Pane" anchor="Calibration" styleclass="Normal" translate="true">Calibration tab for the Lake Package</link><text styleclass="Normal" translate="true"> in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. On the Gage tab, you need to ensure that data of the desired type will be saved.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="MNW2_Multi_Node_Well_Package" styleclass="Normal" translate="true">MNW2</link><text styleclass="Normal" translate="true"> package is used, you can use the head in the well or well flows as calibration observations. </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Calibration_TabMNW2" styleclass="Normal" translate="true">Calibration tab on the MNW2 Package pane</link><text styleclass="Normal" translate="true"> in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SFR_Stream_Flow_Routing_Package" styleclass="Normal" translate="true">SFR</link><text styleclass="Normal" translate="true"> package is used, calibration observations for it can be defined </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Calibration_tabSfr" styleclass="Normal" translate="true">Calibration tab on the SFR pane</link><text styleclass="Normal" translate="true"> and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="GAGE_for_SFR" styleclass="Normal" translate="true">Calibration tab of the Gage Pane</link><text styleclass="Normal" translate="true"> both in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If subsidence is simulated using either the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUB_Subsidence_and_Aquifer_Sys" styleclass="Normal" translate="true">SUB</link><text styleclass="Normal" translate="true"> or </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWT_Package" styleclass="Normal" translate="true">SWT</link><text styleclass="Normal" translate="true"> packages, observations related to subsidence can be defined on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Subsidence_and_Aquifer_System_" styleclass="Normal" translate="true">Sub pane</link><text styleclass="Normal" translate="true"> and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWT_Subsidence_and_Aquifer_Sys" styleclass="Normal" translate="true">SWT pane</link><text styleclass="Normal" translate="true"> both in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWI2_Seawater_Intrusion_Packag" styleclass="Normal" translate="true">Seawater Intrusion</link><text styleclass="Normal" translate="true"> package is used and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWI2_Seawater_Intrusion_Packag" anchor="ISWIOBS" styleclass="Normal" translate="true">observations are used</link><text styleclass="Normal" translate="true">, the &#160;</text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWI2_Seawater_Intrusion_Packa2" styleclass="Normal" translate="true">SWI2 pane</link><text styleclass="Normal" translate="true"> in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box can be used to defines observations of Zeta.</text></para>
    <para styleclass="Heading2_atoc_"><text styleclass="Heading2_atoc_" translate="true">SUTRA</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">SUTRA has a built-in mechanism for defining observations at particular places and times. These fall into two classes. Observations of state variables are specified in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Sutra_State_Calibration_Observ" styleclass="Normal" translate="true">Sutra State Calibration Observations</link><text styleclass="Normal" translate="true"> pane of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. Observations of flow through boundaries and related variables are specified in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Manage_SUTRA_Boundary_Observati" styleclass="Normal" translate="true">Manage SUTRA Boundary Observations</link><text styleclass="Normal" translate="true"> dialog box. </text></para>
    <para styleclass="Heading2_atoc_"><text styleclass="Heading2_atoc_" translate="true">All models</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The difference between two simulated values can be useful as a calibration observation. Typically, such comparisons involved simulated values of the same type and time at different locations defining a spatial gradient or simulated values of the same type and location at different times defining a temporal change. Both types can be defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Observation_Comparisons_Dialog" styleclass="Normal" translate="true">Observation Comparisons</link><text styleclass="Normal" translate="true"> dialog box. Temporal changes typically are defined when a single object is used to specify observations at different time. In such cases, the user can typically define comparison observations in the same dialog where the direct observations are defined.</text></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
