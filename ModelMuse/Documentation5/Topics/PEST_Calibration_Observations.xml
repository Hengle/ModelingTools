<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2022-01-24T16:05:06.421-05:00" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">PEST Calibration Observations</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">PEST Calibration Observations</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When PEST is estimating parameters, it compares simulated values from the model with measurements representing the modeled system. From a model calibration standpoint, it is important to have a variety of different observation types. For example, head observations are typically widely available for calibrating models, but head observations alone are typically insufficient to constrain many important model inputs. For example, if the model parameters include recharge and hydraulic conductivity, head observation data alone only allows for estimation of the ratio of the recharge rate to the hydraulic conductivity but will not allow the independent estimation of both the recharge rate and the hydraulic conductivity (e.g., Haitjema, 2006).  PEST provides means to overcome such parameter correlation (e.g., Tikhonov regularization application of Hunt and others, 2019) but generally a minimum of head and flow type observations are considered necessary for calibration (Anderson and others, 2015).  Inclusion of many types of observations, however, will typically provide more robust calibration results (Hunt and others., 2006).</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Sometimes the difference between two simulated values can be more helpful in estimating parameters than the simulated values themselves (Doherty and Hunt, 2010; Anderson and others, 2015). Typically, such comparisons involve simulated values of the same type and time at different locations that define a spatial gradient or simulated values of the same type and location at different times that define a temporal change. Both types can be defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Observation_Comparisons_Dialog" styleclass="Normal" translate="true">Comparison Observations</link><text styleclass="Normal" translate="true"> dialog box. Temporal changes typically are defined when a single object is used to specify observations at different time. In such cases, the user can typically define comparison observations in the same dialog where the direct observations are defined– usually the Object Properties dialog </text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When ModelMuse generates the model input files, it also generates two input files for one of the utility programs: </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf6ObsExtractor" styleclass="Normal" translate="true">Mf6ObsExtractor</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf2005ObsExtractor" styleclass="Normal" translate="true">Mf2005ObsExtractor</link><text styleclass="Normal" translate="true">, or </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SutraObsExtractor" styleclass="Normal" translate="true">SutraObsExtractor</link><text styleclass="Normal" translate="true">. Depending on the version of the forward model selected, the utility program processes the model output files to generate simulated values that can be compared with observed values. The other input file causes the utility to generate an instruction file used by PEST to read the model results. The instruction file is generated when the model is run from ModelMuse. The simulated values are extracted when PEST is running the model through the RunModel.bat batch file.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">For all calibration observations for PEST, an observation name, the observed value, the weight and an observations group must be defined. Observation weights are important for prioritizing calibration tradeoffs that arise; Doherty and Hunt (2010) and Chapter 9 of Anderson and others (2015), among others, have discussed the importance of weighting for the parameter estimation process. Observation groups are defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="PEST_Properties_Observation_Gr" styleclass="Normal" translate="true">Observation Group Properties</link><text styleclass="Normal" translate="true"> pane of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Heading2_atoc_"><text styleclass="Heading2_atoc_" translate="true">MODFLOW 6</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">MODFLOW 6 provides the “</text><link displaytype="text" defaultstyle="true" type="topiclink" href="OBS_Observation_Utility_Packag" styleclass="Normal" translate="true">Observation Utility</link><text styleclass="Normal" translate="true">” to generate time-series of simulated values of many sorts, including heads, and flows through boundaries. The simulated values are written at each time step and may refer to values at a single cell or to a group of cells. ModelMuse allows the user to define calibration observations for use with PEST based on the output of the Observation Utility. For head observations, calibration observations are computed by interpolating in space and time to the observation location and time. For structured grids, bilinear interpolation is used from the surrounding cell centers within a layer to the observation location. For unstructured (DISV) grids, a linear, triangular, or quadrilateral basis function (Wang and Anderson, 1977) is used for spatial interpolation within a layer. The type of basis function is chosen automatically depending on the number of active cells surrounding the observation. Spatial interpolation among more than 4 points is not supported. Temporal interpolation is performed by linear interpolation between the time preceding and succeeding the observation time. Flows through boundaries may involve adding the flows from several objects. All calibration observations are defined on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="OBS_Observation_Utility_Pane" anchor="Calibration" styleclass="Normal" translate="true">Calibration</link><text styleclass="Normal" translate="true"> tab of the Observation Utility pane of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Multilayer head observations are defined in horizontal space by point observations on the top view of the model in which the multilayer checkbox on the calibration tab is checked and in which the object has information that tells ModelMuse that the point object intersects more than one layer. The information takes the form of “Z formulas” that define the well screened interval. If the multilayer checkbox is not checked, the observation will be treated as a single-cell observation and the cell that has the longest length of intersection between the cell and the well screen will be the cell used for the observation. Transmissivity weighting is applied to the individual cells that make up the multilayer head observations based on the product of the cell hydraulic conductivity in the X direction (Kx) and the length of intersection between the well screen and the cell. The transmissivity weights used for the composite head calculation remain constant during parameter estimation even if Kx is changed during parameter estimation.</text></para>
    <para styleclass="Heading2_atoc_"><text styleclass="Heading2_atoc_" translate="true">MODFLOW-2005</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">MODFLOW-2005 and related models such as MODFLOW-NWT have a built-in mechanism for defining head and flow observations at specified locations and times. There are also several packages that generate simulated values that can be compared with observed values. As described in the MODFLOW-2005 documentation (Harbaugh, 2005; see also Hill and others, 2000), MODFLOW-2005 interpolates head observations in time and space to the location and time of the head observation. Head observations are defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="HOB_Head_Observation_Package" styleclass="Normal" translate="true">Head Observation Package</link><text styleclass="Normal" translate="true">. Individual head observations are specified in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="HOB_Head_Observation_Package_P" styleclass="Normal" translate="true">Head Observations pane of the Object Properties dialog box</link><text styleclass="Normal" translate="true">. Observations of flow through boundaries can be defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="CHOB_Specified_Head_Flow_Observations" styleclass="Normal" translate="true">CHOB</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="DROB_Drain_Observation_Package" styleclass="Normal" translate="true">DROB</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="GBOB_General_Head_Boundary_Observations" styleclass="Normal" translate="true">GBOB</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="RVOB_River_Observation_Package" styleclass="Normal" translate="true">RVOB</link><text styleclass="Normal" translate="true">, and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="STOB_Stream_Observation_Packag" styleclass="Normal" translate="true">STOB</link><text styleclass="Normal" translate="true"> packages. Individual flow observations are defined in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Manage_Flux_Observations" styleclass="Normal" translate="true">Manage Flow Observations</link><text styleclass="Normal" translate="true"> dialog box.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">ModelMuse generates input for </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf2005ObsExtractor" styleclass="Normal" translate="true">Mf2005ObsExtractor</link><text styleclass="Normal" translate="true"> so that output files from several other packages can be used for model calibration (for example, the Gage Package). If the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="LAK_Lake_Package_Pane" styleclass="Normal" translate="true">Lake</link><text styleclass="Normal" translate="true"> package is used, lake gages can be used to export various lake properties such as the lake stage or the inflow or outflow from the lake. These can be used to define calibration observations on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="LAK_Object_Pane" anchor="Calibration" styleclass="Normal" translate="true">Calibration tab for the Lake Package</link><text styleclass="Normal" translate="true"> in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. On the Gage tab, you need to ensure that data of the desired feature type will be saved. If the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="MNW2_Multi_Node_Well_Package" styleclass="Normal" translate="true">MNW2</link><text styleclass="Normal" translate="true"> package is used, the head in the well or well flows can be used as calibration observations. These are defined on Calibration tab on the</text><link displaytype="text" defaultstyle="true" type="topiclink" href="MNW2_Object_Pane" styleclass="Normal" translate="true">MNW2 Package</link><text styleclass="Normal" translate="true"> pane in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. If the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SFR_Stream_Flow_Routing_Package" styleclass="Normal" translate="true">SFR</link><text styleclass="Normal" translate="true"> package is used, calibration observations for it can be defined on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Calibration_tabSfr" styleclass="Normal" translate="true">Calibration</link><text styleclass="Normal" translate="true"> tab on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SFR_Object_Pane" styleclass="Normal" translate="true">SFR</link><text styleclass="Normal" translate="true"> pane and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="GAGE_for_SFR" styleclass="Normal" translate="true">Calibration tab of the Gage</link><text styleclass="Normal" translate="true"> pane, which are both in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true"> ObjectProperties</link><text styleclass="Normal" translate="true"> dialog box. If subsidence is simulated using either the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUB_Subsidence_and_Aquifer_Sys" styleclass="Normal" translate="true">SUB</link><text styleclass="Normal" translate="true"> or </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWT_Package" styleclass="Normal" translate="true">SWT</link><text styleclass="Normal" translate="true"> packages, observations related to subsidence can be defined on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Subsidence_and_Aquifer_System_" styleclass="Normal" translate="true">SUB</link><text styleclass="Normal" translate="true"> and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWT_Subsidence_and_Aquifer_Sys" styleclass="Normal" translate="true">SWT</link><text styleclass="Normal" translate="true"> panes, which are both in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. If the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWI2_Seawater_Intrusion_Packag" styleclass="Normal" translate="true">Seawater Intrusion</link><text styleclass="Normal" translate="true"> package is used and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWI2_Seawater_Intrusion_Packag" anchor="ISWIOBS" styleclass="Normal" translate="true">observations are used</link><text styleclass="Normal" translate="true">, the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWI2_Seawater_Intrusion_Packa2" styleclass="Normal" translate="true">SWI2</link><text styleclass="Normal" translate="true"> pane in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box can be used to defines observations of Zeta. Observations defined for the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SUB_Subsidence_and_Aquifer_Sys" styleclass="Normal" translate="true">SUB</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWT_Package" styleclass="Normal" translate="true">SWT</link><text styleclass="Normal" translate="true">, or </text><link displaytype="text" defaultstyle="true" type="topiclink" href="SWI2_Seawater_Intrusion_Packag" styleclass="Normal" translate="true">Seawater Intrusion</link><text styleclass="Normal" translate="true"> packages are interpolated by </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf2005ObsExtractor" styleclass="Normal" translate="true">Mf2005ObsExtractor</link><text styleclass="Normal" translate="true"> in the same was as head observations are interpolated by MODFLOW-2005.</text></para>
    <para styleclass="Heading2_atoc_"><text styleclass="Heading2_atoc_" translate="true">SUTRA</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">SUTRA has built-in capabilities for defining observations at particular places and times. These fall into two classes. Observations of state variables are specified in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Sutra_State_Calibration_Observ" styleclass="Normal" translate="true">Sutra State Calibration Observations</link><text styleclass="Normal" translate="true"> pane of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties</link><text styleclass="Normal" translate="true"> dialog box. Observations of flow through boundaries and related variables are specified in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Manage_SUTRA_Boundary_Observati" styleclass="Normal" translate="true">Manage SUTRA Boundary Observations</link><text styleclass="Normal" translate="true"> dialog box. </text></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
