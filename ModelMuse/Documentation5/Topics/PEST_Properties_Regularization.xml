<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" status="Under Construction" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Regularization Controls Pane</title>
  <keywords>
    <keyword translate="true">FRACPHIM</keyword>
    <keyword translate="true">LINREG</keyword>
    <keyword translate="true">MEMSAVE</keyword>
    <keyword translate="true">PHIMACCEPT</keyword>
    <keyword translate="true">PHIMLIM</keyword>
    <keyword translate="true">REGCONTINUE</keyword>
    <keyword translate="true">WFFAC</keyword>
    <keyword translate="true">WFINIT</keyword>
    <keyword translate="true">WFMAX</keyword>
    <keyword translate="true">WFMIN</keyword>
    <keyword translate="true">WFTOL</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Regularization Controls Pane</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Strong" translate="true">Regularization Controls </text><text styleclass="Normal" translate="true">pane is on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties Dialog Box</link><text styleclass="Normal" translate="true"> under </text><text styleclass="Strong" translate="true">Regularization</text><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The variables specified on the </text><text styleclass="Strong" translate="true">Regularization Controls</text><text styleclass="Normal" translate="true"> pane are described in the PEST User Manual, Part I, Section 9.2.3). More extensive descriptions of these variables are in the PEST user manual. The variables specified on this pane appear in the Regularisation analysis section of the PEST control file. </text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">PHIMLIM</text><text styleclass="Normal" translate="true"> is the target measurement objective function ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">m</text><text styleclass="Normal" style="font-size:8pt; vertical-align:super;" translate="true">l</text><text styleclass="Normal" translate="true">. This is the measurement objective function that PEST “aims for” while keeping the regularization objective function as low as possible.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">PHIMACCEPT</text><text styleclass="Normal" translate="true"> if PEST succeeds in lowering ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">m</text><text styleclass="Normal" translate="true"> to an acceptable level, or if it has succeeded in doing this on previous iterations, then PEST slightly alters its philosophy of choosing new Marquardt lambdas, in that it now attempts to lower ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">r</text><text styleclass="Normal" translate="true"> while maintaining ϕm below this acceptable level. This acceptable level is PHIMACCEPT; it should be set slightly higher than PHIMLIM (i.e. ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">m</text><text styleclass="Normal" style="font-size:8pt; vertical-align:super;" translate="true">l</text><text styleclass="Normal" translate="true">) in order to give PEST some “room to move” in its attempts to lower ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">r</text><text styleclass="Normal" translate="true"> while keeping ϕm below, or close to, ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">m</text><text styleclass="Normal" style="font-size:8pt; vertical-align:super;" translate="true">l</text><text styleclass="Normal" translate="true">. Normally PHIMACCEPT should be about 5 percent to 10 percent greater than PHIMLIM.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">FRACPHIM</text><text styleclass="Normal" translate="true"> The FRACPHIM variable allows you to set PHIMLIM very low (possibly lower than is achievable), but still retain the benefits of regularization.</text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">If FRACPHIM is provided with a value of zero or less (or if this variable is absent from the PEST control file), then it has no effect on the inversion process. However if FRACPHIM is provided with a value of between 0.0 and 1.0 (values of 1.0 or greater are illegal), then PEST calculates a new value for PHIMLIM at the beginning of each iteration of the inversion process. This value is calculated as the current value of the measurement objective function times FRACPHIM, or the user-supplied value of PHIMLIM, whichever is higher. Thus PEST will always “aim for” a measurement objective function that is lower than the current one. However it does not pursue a target that is so low as to require the complete abandonment of regularization. The recommended value for FRACPHIM is 0.1.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">MEMSAVE</text><text styleclass="Normal" translate="true"> The optional MEMSAVE variable can be used to implement memory conservation features that may assist PEST in very highly parameterized cases. See section 15.7 of the PEST User Manual for further details.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">WFINIT</text><text styleclass="Normal" translate="true"> is the initial regularization weight factor. During every iteration of the inversion process PEST calculates a suitable regularization weight factor to employ during that iteration using an iterative, numerical solution procedure; its initial value when implementing this procedure for the first iteration is WFINIT. If there are many adjustable parameters, calculation of the regularization weight factor for the first iteration can be time-consuming if WFINIT is far from optimal. Hence if you have any idea of what the weight factor should be (for example from a previous PEST run), then you should provide WFINIT with this value. Otherwise simply set it to 1.0.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">WFMIN</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Strong" translate="true">WFMAX</text><text styleclass="Normal" translate="true"> are the minimum and maximum permissible values that the regularization weight factor is allowed to take. Normally settings of 1E-10 and 1E10 are suitable; settings of 1E-15 and 1E15 are normally fine as well. If PEST wishes to transgress these limits it will notify you of this. This normally indicates that regularization constraints are too weak to ensure inverse problem uniqueness (if the upper weight factor limit is encountered), or that measurement weights are too low (if the lower weight factor limit is encountered).</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">WFFAC</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Strong" translate="true">WFTOL</text><text styleclass="Normal" translate="true"> When PEST calculates the appropriate regularization weight factor to use during any iteration of the inversion process, it uses an iterative procedure which begins at the value of the regularization weight factor calculated during the previous iteration; for the first iteration it uses WFINIT to start the procedure. In the process of finding the weight factor which, under the linearity assumption used in its calculation, will result in a measurement objective function (i.e. .m) of PHIMLIM (i.e. ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">m</text><text styleclass="Normal" style="font-size:8pt; vertical-align:super;" translate="true">l</text><text styleclass="Normal" translate="true">), PEST first travels along a path of progressively increasing or decreasing weight factor (it decides which one of these alternatives to explore on the basis of the value of the current measurement objective function with respect to PHIMLIM). In undertaking this exploration, it either multiplies or divides the weight factor by WFFAC; it continues to do this until it has found two successive weight factors which lie on either side of the optimal weight factor for that iteration. Once it has done this, it uses Newton’s method to calculate the optimal weight factor, through a series of successive approximations. When two subsequent weight factors calculated in this way differ from each other by no more than a relative amount of WFTOL, the optimal weight factor is deemed to have been calculated.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">LINREG</text><text styleclass="Normal" translate="true"> Regularization constraints can be supplied through observations, through prior information, or through both of these mechanisms. Prior information relationships are always linear. Regularization constraints supplied as observations (for which the current values of pertinent relationships are calculated by the model), can be linear or nonlinear; in either case, derivatives of these relationships with respect to adjustable parameters are re-evaluated by PEST during each iteration.</text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">If regularization information is entirely linear, there are many matrix operations carried out as part of PEST&apos;s regularization functionality which do not need to be repeated from iteration to iteration. If repetition of these calculations can be avoided in parameter estimation contexts involving many regularization constraints, significant gains in efficiency can be made. The user can inform PEST that all regularization constraints are linear through the optional LINREG control variable.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">REGCONTINUE</text><text styleclass="Normal" translate="true"> Under normal circumstances, when working in “regularization” mode, PEST ceases execution immediately if the measurement objective function falls below its user-supplied target value of PHIMLIM. Therefore it does not undertake further iterations in an attempt to lower the regularization objective function any further in order to maximise the extent to which parameters adhere to the preferred condition that is encapsulated in regularization constraints.</text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">There are some circumstances, however, where minimization of the regularization objective function is just as important as allowing the measurement objective function to reach PHIMLIM. In these circumstances, PEST should continue with the parameter estimation process until some other convergence criterion is met (for example that parameters cease to change noticeably between iterations, or that neither the regularization nor measurement objective function changes noticeably between iterations). This can be achieved with the REGCONTINUE.</text></para>
    <para styleclass="Normal"></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
