<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2022-06-29T10:04:00.576-04:00" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">RmaMf2005: Run PEST</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">RmaMf2005: Run PEST</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">After making all the changes to the model, you have to run the model from ModelMuse one more time. Select </text><text styleclass="Strong" translate="true">File|Export|MODFLOW-2005 Input Files</text><text styleclass="Normal" translate="true">. ModelMuse will start a command line window that will in turn start ModelMonitor to run the model. When the model is done running close ModelMonitor. Several more operations will be performed in the command line window and then the MODFLOW listing file will be opened in a text editor. The operations between when MODFLOW finishes and the listing file is opened consist of creating a kriging factors file and a PEST instruction file. PLPROC is used to create the kriging factors file and </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf2005ObsExtractor" styleclass="Normal" translate="true">Mf2005ObsExtractor</link><text styleclass="Normal" translate="true"> is used to create the instruction file. These files will be used when PEST runs the model.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">In addition to creating the input files for MODFLOW, ModelMuse also created the PEST control file when it ran MODFLOW along with two batch files named RunPestChek.bat and RunPest.bat. PESTCHEK is a PEST utility program that checks the PEST input for errors. It is recommended to always run PESTCHEK before attempting to run PEST. You can run PESTCHEK by double clicking on the RunPestChek.bat file in Windows Explorer. It is normal for some warnings to be present with control files generated by ModelMuse. However, if it reports errors, you will need to fix them. If something is wrong with your parameters, observations, pilot points, or delimiters, you may need to run the model again after fixing them. Otherwise, you will probably just need to export the PEST control file again after fixing the problem in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties</link><text styleclass="Normal" translate="true"> dialog box. To export the PEST control file again, select “</text><text styleclass="Strong" translate="true">File|Export|PEST|Export PEST Control File</text><text styleclass="Normal" translate="true">.” The Save File dialog box will have options to run PESTCHEK, PEST, or not run anything. Choose the option you prefer. When PESTCHECK does not report any errors, you are ready to run PEST. </text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Before running PEST, it would be a good idea to estimate how long one parameter estimation iteration will take. You can estimate that by multiplying the number of parameters by the time required to run the model. The number of parameters is NPAR. It is the first number in the control data section of the PEST control file. The PEST control file is a text file with the extension .pst. You can determine the time required to run the model by comparing the modification dates of the last input file for the model (RunModel.bat) and the last output file from the model (the listing file with the extension .lst). PEST will need multiple parameter estimation iterations to estimate the parameter values so if one parameter estimation iteration takes too long, you will need to simplify the model by, for example, reducing the number of pilot points.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Go ahead and run PEST. For this problem run on a standard desktop, PEST may take more than twenty minutes to finish but can be much faster depending on the characteristics of the computer and on how many other programs are running. &#160;It is good practice to monitor PEST performance during the parameter estimation by opening and inspecting the PEST run record (.rec) file. </text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">While PEST is running, you may wish to read </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Working_with_PEST" styleclass="Normal" translate="true">Working with PEST</link><text styleclass="Normal" translate="true"> if you have not already done so.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When PEST has finished running, you may wish to back up your model input and output files, so you do not accidentally overwrite them later if you run ModelMuse again.</text></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
