<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" status="Under Construction" modified="2022-01-21T14:15:38.611-05:00" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">RmaMF6: Run PEST</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">RmaMF6: Run PEST</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">After making all the changes to the model, you must run the model from ModelMuse. Select </text><text styleclass="Strong" translate="true">File|Export|MODFLOW 6 Input Files</text><text styleclass="Normal" translate="true">. While creating the MODFLOW input files, ModelMuse will create and run a batch file that will create a covariance matrix file for the pilot point parameters. After all the input files have been created, ModelMuse will start a command line window that will in turn start ModelMonitor to run the model. ModelMonitor may display a warning that the model will continue even if convergence is not achieved. This warning may be ignored in this case. The warning appears because the “Continue even if no convergence” checkbox is check in the IMS package as described previously. When the model is done running, close ModelMonitor. Several more operations will be performed in the command line window and then the MODFLOW listing file will be opened in a text editor. The operations that are performed between ModelMonitor closing and the MODFLOW listing file being opened are described below.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The first thing that happens after ModelMonitor is closed is that </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf6ObsExtractor" styleclass="Normal" translate="true">Mf6ObsExtractor</link><text styleclass="Normal" translate="true"> is run. It creates an instruction file that will be used by PEST when it is running. The second thing that happens is that PLPROC is run. It is a utility program that can be downloaded from the PEST homepage. It creates a file that will be used when interpolating among the pilot points.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The first thing that happens after ModelMonitor is closed is that </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Mf6ObsExtractor" styleclass="Normal" translate="true">Mf6ObsExtractor</link><text styleclass="Normal" translate="true"> is run as illustrated below. It creates an instruction file that will be used by PEST to extract model results so that they can be compared to observed values. The second thing that happens is that PLPROC is run. It is a utility program that can be downloaded from the PEST homepage. It creates a file that will be used to populate the model grid among the pilot points.</text></para>
    <para styleclass="Normal"><image src="RmaMF6CommandLineAll.png" scale="-99.90%" styleclass="Image Caption" figurelistinclude="0"><title translate="true">Annotated screen capture identifying purposes of commands in the RunModflow.bat batchfile.</title><caption translate="true"><![CDATA[Annotated screen capture identifying purposes of commands in the RunModflow.bat batchfile.]]></caption></image></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">In addition to creating the input files for MODFLOW, ModelMuse also created the PEST control file when it ran MODFLOW along with two batch files named RunPestChek.bat and RunPest.bat. PESTCHEK is a PEST utility program that checks the PEST input for errors. It is recommended to always run PESTCHEK before attempting to run PEST. You can run PESTCHEK by double clicking on the RunPestChek.bat file in Windows Explorer. It is normal for some warnings to be present with control files generated by ModelMuse. However, if it reports errors, you will need to fix them. If something is wrong with your parameters, observations, pilot points, or delimiters, you may need to run the model again after fixing them. Otherwise, you will probably just need to export the PEST control file again after fixing the problem in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties</link><text styleclass="Normal" translate="true"> dialog box. To export the PEST control file again, select “</text><text styleclass="Strong" translate="true">File|Export|PEST|Export PEST Control File</text><text styleclass="Normal" translate="true">.” The Save File dialog box will have options to run PESTCHEK, PEST, or not run anything. Choose the option you prefer. When PESTCHECK does not report any errors, you are ready to run PEST. Go ahead and run PEST. For this problem run on a standard desktop, PEST may take more than twenty minutes to finish but can be much faster depending on the characteristics of the computer and on how many other programs are running.  It is good practice to monitor PEST performance during the parameter estimation by opening and inspecting the PEST run record (.rec) file. </text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When PEST has finished running, you may wish to back up your model input and output files, so you do not accidentally overwrite them later if you run ModelMuse again.</text></para>
    <para styleclass="Normal"></para>
  </body>
</topic>
