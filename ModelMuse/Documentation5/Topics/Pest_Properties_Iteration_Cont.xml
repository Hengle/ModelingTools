<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" status="Under Construction" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">PEST Properties Iteration Controls Pane</title>
  <keywords>
    <keyword translate="true">LASTRUN</keyword>
    <keyword translate="true">NOPTMAX</keyword>
    <keyword translate="true">NPHINORED</keyword>
    <keyword translate="true">NPHISTP</keyword>
    <keyword translate="true">NRELPAR</keyword>
    <keyword translate="true">PHIABANDON</keyword>
    <keyword translate="true">PHIREDSTP</keyword>
    <keyword translate="true">PHISTOPTHRESH</keyword>
    <keyword translate="true">RELPARSTP</keyword>
  </keywords>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">PEST Properties Iteration Controls Pane</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The </text><text styleclass="Strong" translate="true">Iteration Controls </text><text styleclass="Normal" translate="true">pane is on the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties Dialog Box</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">The variables specified on the </text><text styleclass="Strong" translate="true">Iteration Controls</text><text styleclass="Normal" translate="true"> pane are described in the PEST User Manual, Part I, Section 4.2.9). More extensive descriptions of these variables are in the PEST user manual.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">NOPTMAX</text><text styleclass="Normal" translate="true"> sets the maximum number of iterations that PEST is allowed to undertake on a particular parameter estimation run. </text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">If NOPTMAX is set to 0, PEST will not estimate parameters, nor even calculate a Jacobian matrix. Instead it will terminate execution after just one model run. This setting can be used to ensure that PEST setup is correct; at the same time, it can be used to compute objective function components and residuals based on initial parameter values provided in the PEST control file.</text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">If NOPTMAX is set to -2 PEST will calculate the Jacobian matrix, store it in a JCO file, and then cease execution immediately. This matrix can then be used for linear analysis, and/or for construction of an SVD-assist input dataset.</text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">Setting NOPTMAX to –1 also instructs PEST to compute the Jacobian matrix. However after doing this, PEST records the same information on its output files as that which it would normally record on completion of an inversion process. This includes composite sensitivities and, if pertinent, post-calibration uncertainty and covariance statistics calculated from parameter sensitivities. It then undertakes a final model run so that model input and output files remaining after PEST execution is complete pertain to parameters values provided in the PEST control file.</text></para>
    <para styleclass="Normal"><anchor id="PHIREDSTP" styleclass="Normal"></anchor><text styleclass="Strong" translate="true">PHIREDSTP</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Strong" translate="true">NPHISTP</text><text styleclass="Normal" translate="true"> If, in the course of the parameter estimation process, there have been NPHISTP optimisation iterations for which</text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">(</text><text styleclass="Normal" style="font-family:System;" translate="true">ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">i</text><text styleclass="Normal" translate="true"> - </text><text styleclass="Normal" style="font-family:System;" translate="true">ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">min</text><text styleclass="Normal" translate="true"> )/</text><text styleclass="Normal" style="font-family:System;" translate="true">ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">i</text><text styleclass="Normal" translate="true"> ≤ PHIREDSTP</text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">(</text><text styleclass="Normal" style="font-family:System;" translate="true">ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">i</text><text styleclass="Normal" translate="true"> being the objective function value at the end of the i’th optimisation iteration and </text><text styleclass="Normal" style="font-family:System;" translate="true">ϕ</text><text styleclass="Normal" style="font-size:8pt; vertical-align:sub;" translate="true">min</text><text styleclass="Normal" translate="true"> being the lowest objective function achieved to date), PEST will consider that the inversion process is at an end.</text></para>
    <para styleclass="Normal" style="margin-left:24px;"><text styleclass="Normal" translate="true">For many cases 0.005 and 4 are suitable values for PHIREDSTP and NPHISTP respectively.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">NPHINORED</text><text styleclass="Normal" translate="true"> If PEST has failed to lower the objective function over NPHINORED successive iterations, it will terminate execution. A value of 3 or 4 is often suitable.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">RELPARSTP</text><text styleclass="Normal" translate="true"> and </text><text styleclass="Strong" translate="true">NRELPAR</text><text styleclass="Normal" translate="true"> If the magnitude of the maximum relative parameter change between iterations is less than RELPARSTP over NRELPAR successive iterations, PEST will cease execution. All adjustable parameters, whether they are relative-limited or factor-limited, are involved in the calculation of the maximum relative parameter change. RELPARSTP is a real variable for which a value of 0.005 is often suitable. NRELPAR is an integer variable; a value of 3 or 4 is normally satisfactory.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">PHISTOPTHRESH</text><text styleclass="Normal" translate="true"> If PHISTOPTHRESH is set to a positive number, PEST will cease execution if the objective function falls below this value at the end of any iteration. Note that this criterion is applied to the measurement objective function if PEST is run in “regularisation” mode (see chapter 9 of the PEST User Manual). Alternatively, if PHISTOPTHRESH is set to zero or a negative number, then it is ignored. ModelMuse aultimatlcally exports PHISTOPTHRESH as zero in “predictive analysis” or “pareto” modes.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">LASTRUN</text><text styleclass="Normal" translate="true"> If LASTRUN is set to activated, then PEST will undertake a final model run using optimised parameters upon termination of execution. ModelMuse automatically deactivates LASTRUN in “pareto” mode.</text></para>
    <para styleclass="Normal"><text styleclass="Strong" translate="true">PHIABANDON</text><text styleclass="Normal" translate="true"> If, at the end of the first model run, and any iteration thereafter, the objective function (or measurement objective function if PEST is run in “regularisation” mode) is greater than PHIABANDON, PEST will terminate execution. Set this to a very high number, or to a non-positive number (or omit it altogether), for it to have no effect.</text></para>
  </body>
</topic>
