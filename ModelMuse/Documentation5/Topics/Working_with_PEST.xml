<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" status="Under Construction" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Working with PEST</title>
  <body>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">PEST is a free program by John Doherty for calibrating models. Its theory is documented in </text><link displaytype="text" defaultstyle="true" type="topiclink" href="References_Cited" styleclass="Normal" translate="true">Doherty (2015)</link><text styleclass="Normal" translate="true"> and its usage is documented in its user manual which comes with the program. PEST is available from </text><link displaytype="text" defaultstyle="true" type="weblink" href="https://www.pesthomepage.org" target="_blank" styleclass="Normal" translate="true">www.pesthomepage.org</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Before starting to work with PEST, you need to have a clear goal for your model. What question do you want your model to answer? What decision do you need to make and how will your model help you make that decision. For example, if a farmer applies for a permit to pump additional groundwater for irrigation, a regulator might use a model to predict how the pumping will affect other users and based on that prediction might grant or deny the permit. A city might want to have a new well to supply drinking water but is concerned about sea water intrusion. A model might be used to help predict the optimal location for the well.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">For a groundwater model, you also need to have a model that incorporates your understanding of the processes that govern groundwater flow in the area of interest. Gordan Bennett expressed this well. &quot;When you started to have that problem, when you couldn&apos;t get a solution, you could get help with that. You could not get any help if you had a conceptual screw-up in your understanding of the regional hydrology. If you didn&apos;t have a rough idea of what the evapotranspiration was, of what the big streams were doing, and how the stream flow was related to groundwater, there&apos;s where you could get into trouble where nobody else could help you.&quot; (Gordon Bennett in an interview, Feb. 21, 2019.)</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">PEST is used to calibrate a model by varying some of the inputs to the model so that the simulated values generated by the model more closely approach comparable observed values. The hope is that by more closely matching the observations, the model will also make more accurate predictions. PEST will run your model many times during this process. For that reason, it is important that your model run well; it should not terminate prematurely because of problems with the input or because of convergence failure. It is also important that your model not take too long to run. If your model takes to long to run, it may be impractical to calibrate it with PEST. A convenient rule of thumb is that the run time should be less than 30 minutes for parameter estimation with PEST to be practical. However, the larger the number of parameters to be estimated, the longer it will take to calibrate the model and so the shorter the run time needs to be.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Of course, to match simulated values with observed values, you must have observed values. Head observations are commonly used in calibrating models but head observations alone are typically insufficient to constrain many important model inputs. For example, if your model involves just recharge and specified heads, head observations may allow you to estimate the ratio of the recharge rate to the hydraulic conductivity but will not allow you to estimate the values of either the recharge rate or the hydraulic conductivity independent of one another. For that you need other types of observations such as measurements of flow through the constant head boundaries. It is common for the most important predictions of a groundwater flow model to be predictions of flow. With just head observations, predictions of flow are difficult to make so it is important to have multiple types of observations.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">To install PEST, download the distribution file and extract it to an empty directory. ModelMuse also uses some of the groundwater utilities for PEST and PLPROC both or which can be downloaded from </text><link displaytype="text" defaultstyle="true" type="weblink" href="https://www.pesthomepage.org" target="_blank" styleclass="Normal" translate="true">www.pesthomepage.org</link><text styleclass="Normal" translate="true">. ModelMuse assumes that PEST, PLPROC, and the groundwater utilities are all installed in the same directory. You will need to specify the directory in which PEST is installed in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Basic_Pane" styleclass="Normal" translate="true">Basic Pane</link><text styleclass="Normal" translate="true"> of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties Dialog Box</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">If you wish to use PEST with a model, you activate PEST in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Basic_Pane" styleclass="Normal" translate="true">Basic Pane</link><text styleclass="Normal" translate="true"> of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties Dialog Box</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When PEST is calibrating a model, it does so by changing some of the model inputs. You must decide which model inputs PEST is allowed to vary. You do that by first defining parameters in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Manage_Parameters_Dialog_Box" styleclass="Normal" translate="true">Manage Parameters Dialog Box</link><text styleclass="Normal" translate="true"> or for some MODFLOW packages in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="MODFLOW_Packages_Dialog_Box" styleclass="Normal" translate="true">MODFLOW Packages and Programs Dialog Box</link><text styleclass="Normal" translate="true"> and then using them in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Sets_Dialog_Box" styleclass="Normal" translate="true">Data Sets Dialog Box</link><text styleclass="Normal" translate="true"> or the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties Dialog Box</link><text styleclass="Normal" translate="true">. </text></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Using_Parameters_with_Data_Set" styleclass="Normal" translate="true">Using Parameters with Data Sets</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Using_PEST_Parameters_with_Mod" styleclass="Normal" translate="true">Using PEST Parameters with Model Features</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="PEST_Calibration_Observations" styleclass="Normal" translate="true">PEST Calibration Observations</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="PEST_Control_Variables" styleclass="Normal" translate="true">PEST Control Variables</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Using_Singlular_Value_Decompos" styleclass="Normal" translate="true">Using Singlular Value Decomposition</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Visualizing_Modified_Model_Inp" styleclass="Normal" translate="true">Visualizing Modified Model Input</link></para>
  </body>
</topic>
