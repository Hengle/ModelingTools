<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="../helpproject.xsl" ?>
<topic template="Default" modified="2024-06-25T10:34:33.777-04:00" lasteditedby="rbwinst" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="../helpproject.xsd">
  <title translate="true">Working with PEST</title>
  <body>
    <header>
      <para styleclass="Heading1"><text styleclass="Heading1" translate="true">Working with PEST</text></para>
    </header>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">PEST (</text><link displaytype="text" defaultstyle="true" type="topiclink" href="References_Cited" styleclass="Normal" translate="true">Doherty, 2015</link><text styleclass="Normal" translate="true">, </text><link displaytype="text" defaultstyle="true" type="weblink" href="https://www.pesthomepage.org" target="_blank" styleclass="Normal" translate="true">www.pesthomepage.org</link><text styleclass="Normal" translate="true">) is a model-independent program for parameter estimation. &#160;Before starting to work with any model, it is important to have a clear goal for the model (Anderson et al., 2015): What question should the model to answer? What decision will need to be made and how will the model aid in making that decision? For example, if a farmer applies for a permit to pump additional groundwater for irrigation, a regulator might grant or deny the permit by using a model to predict how the pumping will affect other users. A city might want to have a new well to supply drinking water but is concerned about sea water intrusion. A model might be used to help predict whether a proposed location for the well is suitable. In each case, the model purpose determines which features of the natural system are needed to be retained and which can be omitted, which in term determines how the model is constructed and calibrated (Anderson and others, 2015).</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">A groundwater model needs to incorporate the processes that govern groundwater flow in the area of interest. Gordan Bennett expressed this well. &quot;When you started to have that problem, when you couldn&apos;t get a solution, you could get help with that. You could not get any help if you had a conceptual screw-up in your understanding of the regional hydrology. If you didn&apos;t have a rough idea of what the evapotranspiration was, of what the big streams were doing, and how the stream flow was related to groundwater, there&apos;s where you could get into trouble….&quot; (Bennett, personal communication, Feb. 21, 2019.)</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">Before starting to calibrate the model with PEST, the modeler will typically attempt to manually modify the model to get as good a fit as possible. Manual calibration typically involves many types of model modification that are not available in automated calibration programs such as PEST. For example, the modeler might make modifications such as</text></para>
    <list id="0" type="ul" listtype="bullet" formatstring="&#183;" format-charset="SYMBOL_CHARSET" levelreset="true" legalstyle="false" startfrom="1" styleclass="Normal" style="font-family:Symbol; font-size:12pt; color:#000000;">
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Changing the delineation of the study area.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Changing the number of layers.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Changing the horizontal extent of some layers.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Changing the locations of boundary conditions.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Changing the type of boundary conditions.</text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Adjusting the number of stress periods or the number of time steps. </text></li>
      <li styleclass="Normal"><text styleclass="Normal" translate="true">Modifying input values that are poorly constrained by the data.</text></li>
    </list>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">A brief discussion of using parameter estimation is provided here but is necessarily only a small subset of an expansive subject; those interested in more encompassing discussions of using PEST for groundwater model calibration are referred to Doherty and Hunt (2010) and Anderson and others (2015). PEST assists model calibration by varying selected inputs to the model (parameters) so that the simulated values generated by the model more closely approach comparable observed values. The hope is that by more closely matching the observations, the model will reduce prediction uncertainty. At the same time, overfitting the model is a danger that the modeler needs to avoid (Anderson and others,2015). PEST will run the model many times during this process. For that reason, it is important for the model to run well; it should not terminate prematurely because of problems with the input or because of convergence failure. It is also important that the model not take too long to run, or it may be impractical to calibrate it with PEST without parallel computing. For many parameter estimation algorithms, the larger the number of parameters to be estimated, the longer it will take to calibrate the model and the more advantageous the shorter run time. Recent advances in calibration algorithms, however, have been shown to appreciably reduce the computational burden of calibration (Hunt et al., 2021), so the relation between parameter number and estimation runtime becoming less coupled. &#160;</text></para>
    <para styleclass="Heading2_atoc_"><text styleclass="Heading2_atoc_" translate="true">Installing PEST</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">To install PEST, download the distribution file and extract it to an empty directory. ModelMuse also uses PLPROC and some of the groundwater utilities for PEST both or which can be downloaded from </text><link displaytype="text" defaultstyle="true" type="weblink" href="https://www.pesthomepage.org" target="_blank" styleclass="Normal" translate="true">www.pesthomepage.org</link><text styleclass="Normal" translate="true">. ModelMuse assumes that PEST, PLPROC, and the groundwater utilities are all installed in the same directory. You will need to specify the directory in which PEST is installed in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Basic_Pane" styleclass="Normal" translate="true">Basic pane</link><text styleclass="Normal" translate="true"> of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties dialog box</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">There are alternate versions of the PEST executable that can be downloaded. For example, with PEST version 17.3, you can install PEST from pest17.zip or from i64execs.zip. The executables in i64execs.zip mostly have &quot;i64&quot; as a prefix to the file name. When running PEST or its utility programs ModelMuse will look for all versions of the executable name in the PEST directory and will use the first one it finds. If it does not find an appropriate executable, it will generate an error message.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">There is no &quot;i64&quot; version of one of the utilities used by ModelMuse: PSTCLEAN. Be sure to install it from pest17.zip or from a more recent version of PEST if one exists. </text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">To use PEST with a model, PEST must be activated in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Basic_Pane" styleclass="Normal" translate="true">Basic pane</link><text styleclass="Normal" translate="true"> of the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Pest_Properties_Dialog_Box" styleclass="Normal" translate="true">PEST Properties dialog box</link><text styleclass="Normal" translate="true">.</text></para>
    <para styleclass="Normal"><text styleclass="Normal" translate="true">When PEST is calibrating a model, it does so by changing some of the model inputs. You must decide which model inputs PEST is allowed to vary. You do that by first defining parameters in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Manage_Parameters_Dialog_Box" styleclass="Normal" translate="true">Manage Parameters dialog box</link><text styleclass="Normal" translate="true"> or for some MODFLOW packages in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="MODFLOW_Packages_Dialog_Box" styleclass="Normal" translate="true">MODFLOW Packages and Programs dialog box</link><text styleclass="Normal" translate="true"> and then using the parameters in the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Data_Sets_Dialog_Box" styleclass="Normal" translate="true">Data Sets dialog box</link><text styleclass="Normal" translate="true"> or the </text><link displaytype="text" defaultstyle="true" type="topiclink" href="Object_Properties_Dialog_Box" styleclass="Normal" translate="true">Object Properties dialog box</link><text styleclass="Normal" translate="true">. </text></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Is-it-Practical-to-Use-PEST_" styleclass="Normal" translate="true">Is it Practical to Use PEST?</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Using_Parameters_with_Data_Set" styleclass="Normal" translate="true">Using Parameters with Data Sets</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Using_PEST_Parameters_with_Mod" styleclass="Normal" translate="true">Using PEST Parameters with Model Features</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="PEST_Calibration_Observations" styleclass="Normal" translate="true">PEST Calibration Observations</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="PEST_Control_Variables" styleclass="Normal" translate="true">PEST Control Variables</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Running_PEST" styleclass="Normal" translate="true">Running PEST</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Using_Singlular_Value_Decompos" styleclass="Normal" translate="true">Using SVD Assist</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Visualizing_Residuals" styleclass="Normal" translate="true">Visualizing Residuals</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Visualizing_Modified_Model_Inp" styleclass="Normal" translate="true">Visualizing Modified Model Input</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Unsupported_PEST_Capabilities" styleclass="Normal" translate="true">Unsupported PEST Capabilities</link></para>
    <para styleclass="Normal"><link displaytype="text" defaultstyle="true" type="topiclink" href="Other_Limitations" styleclass="Normal" translate="true">Limitations</link></para>
  </body>
</topic>
